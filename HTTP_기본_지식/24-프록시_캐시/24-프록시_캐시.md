# 프록시 캐시

## Origin 서버에 직접 접근하는 경우
실제 리소스가 존재하는 서버를 origin 서버라고 한다. 만약 한국에 있는 클라이언트가 미국에 위치한 origin 서버에 직접 접근하려면 상대적으로 오랜 시간이 걸릴 것이다.

##### Origin 서버에 직접 접근하는 경우
![](스크린샷%202022-04-26%20오후%204.28.38.png)
- 모든 클라이언트가 접속에 오랜 시간이 걸린다.

## 프록시 캐시 도입
Origin 서버로의 직접 접속 지연을 해결하기 위해 프록시 캐시 서버를 도입할 수 있다.

##### 프록시 캐시를 도입한 경우
![](스크린샷%202022-04-26%20오후%204.29.38.png)
- Origin 서버로의 요청이 발생하면, 프록시 캐시 서버를 거쳐서 요청이 가도록 한다.
- 프록시 서버는 상대적으로 가까이 있으므로 응답시간이 빠르다.
- 어떤 리소스를 처음으로 요청하는 경우 프록시에 캐싱이 되어있지 않을 것이다. 따라서 처음으로 요청하는 클라이언트는 여전히 느린 응답시간을 경험할 수밖에 없다 (이런 현상을 방지하기 위해 프록시에 미리 캐시를 밀어넣는 경우도 있다)

>참고: 유튜브를 볼 때 조회수가 낮은 영상을 보면 로딩이 매우 느린 경험을 해 봤을 것이다. 반대로 조회수가 높은 영상은 로딩이 매우 빠르다. 캐싱 유무의 차이 때문에 발생하는 현상이다.

##### Private 캐시와 Public 캐시
![](스크린샷%202022-04-26%20오후%204.31.15.png)
- **Private 캐시**: 로컬, 웹 브라우저에 저장되는 캐시
- **Public 캐시**: 프록시 등에 위치해서 공용으로 사용되는 캐시

## Cache-Control을 통한 캐시 제어
- **Cache-Control: public**
	- 응답이 public 캐시에 저장되어도 됨
- **Cache-Control: private**
	- 응답이 해당 사용자만을 위한 것임. 반드시 private 캐시에만 저장해야 한다.
	- 사용자 로그인 정보가 public 캐시에 저장된다면? -> 매우 위험하다!
	- default 값이다.
- Cache-Control: s-maxage
	- 프록시 캐시에만 적용되는 max-age
- Age: 60 (HTTP 헤더)
	- 오리진 서버에서 응답 후 프록시 캐시 내에 머문 시간. 단위는 초.